!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).onScreenness=t()}(this,function(){"use strict";const e=function(e,t){return Number(Math.round(e+"e"+t)+"e-"+t)},t=function(e){return e.split(",").map(e=>e.trim().replace(/\s+/g," ")).filter(e=>e.length)},n=function(e){var t=[];return t.push.apply(t,document.querySelectorAll(e)),t};let r=function(){const e="[data-onscreenness]";let r={},o=[];return{collect:function(e,n=null){let o=t(e);return o.forEach(e=>{r[e]="function"==typeof n?n:null}),o},exclude:function(e){let n=t(e);var r;return r=o,n.forEach(e=>{r.includes(e)||r.push(e)}),n},remove:function(e){let n=t(e),o=function(e,t){let n={},r=[];return e.map(e=>n[e]=1),t.map(e=>{1===n[e]&&(r.push(e),delete n[e])}),r}(Object.keys(r),n);return o.forEach(e=>{delete r[e]}),o},reset:function(){return r={},o=[],[e]},getVariables:()=>({queryList:Object.assign({},r),queryKeys:Object.keys(r),blackList:o.concat()}),buildElementList:function(){let t=[e].concat(Object.keys(r)),i=n(t.join(",")),c=o.length?n(o.join(",")):[];return i.filter(e=>!c.includes(e))}}}(),o={detachIdentifiers:function(e){(e.length?n(e.join(",")):[]).forEach(function(e){e&&(e.classList.remove("onscreen"),e.classList.remove("offscreen"),e.classList.remove("crossscreen"),e.classList.remove("overscreen"),delete e.dataset.onscreenness,delete e.dataset.overlapping)})},calculatePresence:function(e){var t={left:0-e.left,right:e.right-document.documentElement.clientWidth,top:0-e.top,bottom:e.bottom-document.documentElement.clientHeight},n=Math.min(Math.max(t.left,0),e.width),r=Math.min(Math.max(t.right,0),e.width),o=Math.min(Math.max(t.top,0),e.height),i=Math.min(Math.max(t.bottom,0),e.height),c=1-n/e.width-r/e.width,u=1-o/e.height-i/e.height,a=(e.width-n-r)/document.documentElement.clientWidth,s=(e.height-o-i)/document.documentElement.clientHeight;return{horizonOverlap:a,verticaOverlap:s,surfaceOverlap:a*s,horizonPresence:c,verticaPresence:u,surfacePresence:c*u}},attachIdentifiers:function(t,n){var r=e(n.surfacePresence,3);t.dataset.onscreenness=String(r);var o=t.classList.contains("onscreen");1!==r||o||t.classList.add("onscreen"),r<1&&o&&t.classList.remove("onscreen");var i=t.classList.contains("crossscreen");r>0&&r<1&&!i&&t.classList.add("crossscreen"),0!==r&&1!==r||!i||t.classList.remove("crossscreen");var c=t.classList.contains("offscreen");0!==r||c||t.classList.add("offscreen"),r>0&&c&&t.classList.remove("offscreen");var u=e(n.surfaceOverlap,3);t.dataset.overlapping=String(u);var a=1===n.verticaOverlap&&1===n.horizonOverlap||1===n.verticaOverlap&&1===n.horizonPresence||1===n.horizonOverlap&&1===n.verticaPresence,s=t.classList.contains("overscreen");a&&!s&&t.classList.add("overscreen"),!a&&s&&t.classList.remove("overscreen")}};var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function c(e,t){return e(t={exports:{}},t.exports),t.exports}var u,a,s,f,l="object",d=function(e){return e&&e.Math==Math&&e},h=d(typeof globalThis==l&&globalThis)||d(typeof window==l&&window)||d(typeof self==l&&self)||d(typeof i==l&&i)||Function("return this")(),p=function(e){try{return!!e()}catch(e){return!0}},v=!p(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),y={}.propertyIsEnumerable,m=Object.getOwnPropertyDescriptor,g={f:m&&!y.call({1:2},1)?function(e){var t=m(this,e);return!!t&&t.enumerable}:y},b=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},L={}.toString,S=function(e){return L.call(e).slice(8,-1)},w="".split,O=p(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return"String"==S(e)?w.call(e,""):Object(e)}:Object,E=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},M=function(e){return O(E(e))},P=function(e){return"object"==typeof e?null!==e:"function"==typeof e},j=function(e,t){if(!P(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!P(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!P(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!P(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},T={}.hasOwnProperty,I=function(e,t){return T.call(e,t)},x=h.document,A=P(x)&&P(x.createElement),k=!v&&!p(function(){return 7!=Object.defineProperty(("div",A?x.createElement("div"):{}),"a",{get:function(){return 7}}).a}),C=Object.getOwnPropertyDescriptor,V={f:v?C:function(e,t){if(e=M(e),t=j(t,!0),k)try{return C(e,t)}catch(e){}if(I(e,t))return b(!g.f.call(e,t),e[t])}},_=function(e){if(!P(e))throw TypeError(String(e)+" is not an object");return e},N=Object.defineProperty,z={f:v?N:function(e,t,n){if(_(e),t=j(t,!0),_(n),k)try{return N(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},D=v?function(e,t,n){return z.f(e,t,b(1,n))}:function(e,t,n){return e[t]=n,e},G=function(e,t){try{D(h,e,t)}catch(n){h[e]=t}return t},F=c(function(e){var t=h["__core-js_shared__"]||G("__core-js_shared__",{});(e.exports=function(e,n){return t[e]||(t[e]=void 0!==n?n:{})})("versions",[]).push({version:"3.1.3",mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),H=F("native-function-to-string",Function.toString),R=h.WeakMap,q="function"==typeof R&&/native code/.test(H.call(R)),W=0,B=Math.random(),K=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++W+B).toString(36)},Y=F("keys"),J={},Q=h.WeakMap;if(q){var U=new Q,X=U.get,Z=U.has,$=U.set;u=function(e,t){return $.call(U,e,t),t},a=function(e){return X.call(U,e)||{}},s=function(e){return Z.call(U,e)}}else{var ee=Y[f="state"]||(Y[f]=K(f));J[ee]=!0,u=function(e,t){return D(e,ee,t),t},a=function(e){return I(e,ee)?e[ee]:{}},s=function(e){return I(e,ee)}}var te,ne,re,oe={set:u,get:a,has:s,enforce:function(e){return s(e)?a(e):u(e,{})},getterFor:function(e){return function(t){var n;if(!P(t)||(n=a(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},ie=c(function(e){var t=oe.get,n=oe.enforce,r=String(H).split("toString");F("inspectSource",function(e){return H.call(e)}),(e.exports=function(e,t,o,i){var c=!!i&&!!i.unsafe,u=!!i&&!!i.enumerable,a=!!i&&!!i.noTargetGet;"function"==typeof o&&("string"!=typeof t||I(o,"name")||D(o,"name",t),n(o).source=r.join("string"==typeof t?t:"")),e!==h?(c?!a&&e[t]&&(u=!0):delete e[t],u?e[t]=o:D(e,t,o)):u?e[t]=o:G(t,o)})(Function.prototype,"toString",function(){return"function"==typeof this&&t(this).source||H.call(this)})}),ce=h,ue=function(e){return"function"==typeof e?e:void 0},ae=Math.ceil,se=Math.floor,fe=function(e){return isNaN(e=+e)?0:(e>0?se:ae)(e)},le=Math.min,de=function(e){return e>0?le(fe(e),9007199254740991):0},he=Math.max,pe=Math.min,ve=function(e){return function(t,n,r){var o,i=M(t),c=de(i.length),u=function(e,t){var n=fe(r);return n<0?he(n+t,0):pe(n,t)}(0,c);if(e&&n!=n){for(;c>u;)if((o=i[u++])!=o)return!0}else for(;c>u;u++)if((e||u in i)&&i[u]===n)return e||u||0;return!e&&-1}},ye=(ve(!0),ve(!1)),me=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"].concat("length","prototype"),ge={f:Object.getOwnPropertyNames||function(e){return function(e,t){var n,r=M(e),o=0,i=[];for(n in r)!I(J,n)&&I(r,n)&&i.push(n);for(;t.length>o;)I(r,n=t[o++])&&(~ye(i,n)||i.push(n));return i}(e,me)}},be={f:Object.getOwnPropertySymbols},Le=function(e,t){return arguments.length<2?ue(ce[e])||ue(h[e]):ce[e]&&ce[e][t]||h[e]&&h[e][t]}("Reflect","ownKeys")||function(e){var t=ge.f(_(e)),n=be.f;return n?t.concat(n(e)):t},Se=function(e,t){for(var n=Le(t),r=z.f,o=V.f,i=0;i<n.length;i++){var c=n[i];I(e,c)||r(e,c,o(t,c))}},we=/#|\.prototype\./,Oe=function(e,t){var n=Me[Ee(e)];return n==je||n!=Pe&&("function"==typeof t?p(t):!!t)},Ee=Oe.normalize=function(e){return String(e).replace(we,".").toLowerCase()},Me=Oe.data={},Pe=Oe.NATIVE="N",je=Oe.POLYFILL="P",Te=Oe,Ie=V.f,xe=Array.isArray||function(e){return"Array"==S(e)},Ae=!!Object.getOwnPropertySymbols&&!p(function(){return!String(Symbol())}),ke=h.Symbol,Ce=F("wks"),Ve=Ce[te="species"]||(Ce[te]=Ae&&ke[te]||(Ae?ke:K)("Symbol."+te)),_e=function(e,t){var n;return xe(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!xe(n.prototype)?P(n)&&null===(n=n[Ve])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},Ne=[].push,ze=function(e){var t=1==e,n=2==e,r=3==e,o=4==e,i=6==e,c=5==e||i;return function(u,a,s,f){for(var l,d,h=Object(E(u)),p=O(h),v=function(e,t,n){if(function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function")}(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}(a,s,3),y=de(p.length),m=0,g=f||_e,b=t?g(u,y):n?g(u,0):void 0;y>m;m++)if((c||m in p)&&(d=v(l=p[m],m,h),e))if(t)b[m]=d;else if(d)switch(e){case 3:return!0;case 5:return l;case 6:return m;case 2:Ne.call(b,l)}else if(o)return!1;return i?-1:r||o?o:b}},De=[ze(0),ze(1),ze(2),ze(3),ze(4),ze(5),ze(6)][0],Ge=(ne=[].forEach)&&p(function(){ne.call(null,function(){throw 1},1)})?[].forEach:function(e){return De(this,e,arguments.length>1?arguments[1]:void 0)};for(var Fe in function(e,t){var n,r,o,i,c,u=e.target,a=e.global,s=e.stat;if(n=a?h:s?h[u]||G(u,{}):(h[u]||{}).prototype)for(r in t){if(i=t[r],o=e.noTargetGet?(c=Ie(n,r))&&c.value:n[r],!Te(a?r:u+(s?".":"#")+r,e.forced)&&void 0!==o){if(typeof i==typeof o)continue;Se(i,o)}(e.sham||o&&o.sham)&&D(i,"sham",!0),ie(n,r,i,e)}}({target:"Array",proto:!0,forced:[].forEach!=Ge},{forEach:Ge}),{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var He=h[Fe],Re=He&&He.prototype;if(Re&&Re.forEach!==Ge)try{D(Re,"forEach",Ge)}catch(i){Re.forEach=Ge}}var qe=(re=function(e){e instanceof Array||(e=[e]),e.forEach(function(e){return e()})},{onInteractive:function(e){"loading"===document.readyState?window.addEventListener("DOMContentLoaded",function(t){re(e)}):re(e)},onComplete:function(e){"complete"===document.readyState?re(e):window.addEventListener("load",function(t){re(e)})}});return function(){var e=function(){r.buildElementList().forEach(function(e){var t=e.getBoundingClientRect(),n=o.calculatePresence(t);o.attachIdentifiers(e,n)})};window.addEventListener("resize",e,!1),window.addEventListener("scroll",e,!0);let t=new MutationObserver(function(t,n){t.length&&e()});return qe.onInteractive([e,function(){t.observe(document.body,{childList:!0,subtree:!0})}]),{publicAPI:{collect:function(t){r.collect(t),qe.onInteractive([e])},exclude:function(t){qe.onInteractive([function(){o.detachIdentifiers(r.exclude(t))},e])},remove:function(t){qe.onInteractive([function(){o.detachIdentifiers(r.remove(t))},e])},reset:function(){qe.onInteractive([function(){o.detachIdentifiers(r.reset())}])}},testSuite:{getVariables:r.getVariables,trigger:e,liveList:r.buildElementList,calculate:o.calculatePresence,treat:o.attachIdentifiers}}}().publicAPI});
//# sourceMappingURL=index.js.map
